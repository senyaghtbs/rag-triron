#!/bin/bash

echo "๐ฅ ะะฐะณััะถะฐะตะผ ัะตััะพะฒัะต ะดะฐะฝะฝัะต ัะตัะตะท curl..."

articles=(
    '{"text": "Python ะฟะพะฟัะปััะตะฝ ะดะปั ะฒะตะฑ-ัะฐะทัะฐะฑะพัะบะธ, ะฐะฝะฐะปะธะทะฐ ะดะฐะฝะฝัั ะธ ะธัะบััััะฒะตะฝะฝะพะณะพ ะธะฝัะตะปะปะตะบัะฐ.", "category": "programming"}'
    '{"text": "Docker ะบะพะฝัะตะนะฝะตัั ะพะฑะตัะฟะตัะธะฒะฐัั ะธะทะพะปััะธั ะฟัะธะปะพะถะตะฝะธะน ะธ ะธั ะทะฐะฒะธัะธะผะพััะตะน.", "category": "devops"}'
    '{"text": "Kubernetes ะฐะฒัะพะผะฐัะธะทะธััะตั ัะฐะทะฒะตัััะฒะฐะฝะธะต ะธ ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต ะบะพะฝัะตะนะฝะตัะพะฒ.", "category": "devops"}'
    '{"text": "ะะฐัะธะฝะฝะพะต ะพะฑััะตะฝะธะต ะธัะฟะพะปัะทัะตั ะฐะปะณะพัะธัะผั ะดะปั ะพะฑััะตะฝะธั ะฝะฐ ะดะฐะฝะฝัั.", "category": "ai"}'
    '{"text": "React ะธัะฟะพะปัะทัะตััั ะดะปั ัะพะทะดะฐะฝะธั ะธะฝัะตัะฐะบัะธะฒะฝัั ะฟะพะปัะทะพะฒะฐัะตะปััะบะธั ะธะฝัะตััะตะนัะพะฒ.", "category": "web"}'
    '{"text": "Git ะฟะพะทะฒะพะปัะตั ะพััะปะตะถะธะฒะฐัั ะธะทะผะตะฝะตะฝะธั ะฒ ะบะพะดะต ะธ collaborate ั ะดััะณะธะผะธ ัะฐะทัะฐะฑะพััะธะบะฐะผะธ.", "category": "devops"}'
    '{"text": "SQL ะธัะฟะพะปัะทัะตััั ะดะปั ัะฐะฑะพัั ั ัะตะปััะธะพะฝะฝัะผะธ ะฑะฐะทะฐะผะธ ะดะฐะฝะฝัั.", "category": "databases"}'
    '{"text": "JavaScript ัะฐะฑะพัะฐะตั ะฒ ะฑัะฐัะทะตัะต ะธ ะฝะฐ ัะตัะฒะตัะต ัะตัะตะท Node.js.", "category": "programming"}'
    '{"text": "ะัะบััััะฒะตะฝะฝัะน ะธะฝัะตะปะปะตะบั ะฒะบะปััะฐะตั ะบะพะผะฟัััะตัะฝะพะต ะทัะตะฝะธะต ะธ ะพะฑัะฐะฑะพัะบั ะตััะตััะฒะตะฝะฝะพะณะพ ัะทัะบะฐ.", "category": "ai"}'
    '{"text": "ะะฐะทั ะดะฐะฝะฝัั ััะฐะฝัั ััััะบัััะธัะพะฒะฐะฝะฝัั ะธะฝัะพัะผะฐัะธั ะดะปั ะฑััััะพะณะพ ะดะพัััะฟะฐ.", "category": "databases"}'
)

for i in "${!articles[@]}"; do
    echo "ะะพะฑะฐะฒะปัะตะผ ััะฐััั $((i+1))..."
    
    # ะะพะปััะฐะตะผ ะฒะตะบัะพั
    text=$(echo "${articles[$i]}" | jq -r '.text')
    vector=$(curl -s -X POST http://localhost:8080/vectors \
        -H "Content-Type: application/json" \
        -d "{\"text\": \"$text\"}" | jq -r '.vector | @json')
    
    # ะะพะฑะฐะฒะปัะตะผ ะฒ Qdrant
    curl -s -X PUT "http://localhost:6333/collections/documents/points?wait=true" \
        -H "Content-Type: application/json" \
        -d "{
            \"points\": [{
                \"id\": $((i+2000)),
                \"vector\": $vector,
                \"payload\": ${articles[$i]}
            }]
        }" > /dev/null
    
    echo "โ ะะพะฑะฐะฒะปะตะฝะพ: $text"
done

echo "๐ ะัะต ะดะฐะฝะฝัะต ะทะฐะณััะถะตะฝั!"
